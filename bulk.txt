  async bulkUpload(file: Express.Multer.File){
    console.log(file)
    let data = await xlsx2json(file.path);
    console.log("xlsx data------------",data)
  }

  

  @Post('/bulk-upload')
  @UseInterceptors(FileInterceptor('file'))
  bulkUpload(@UploadedFile() file: Express.Multer.File){
    const bulkAdd = this.resourceService.bulkUpload(file);
    return Response.ok('Resources are created successfully',bulkAdd);
  }


  //new

  
  async bulkUpload(file: Express.Multer.File) {
    const workbook = XLSX.readFile(file.path);
    const sheetName = workbook.SheetNames[0]; 
    const worksheet = workbook.Sheets[sheetName];

    const jsonData = XLSX.utils.sheet_to_json(worksheet, { defval: null });

    const filteredData:any = jsonData.filter(row => {
      return Object.values(row).some(cell => cell !== null && cell !== undefined && cell !== '');
    });
   console.log(filteredData)
    const result =await this.resourceModel.bulkCreate(filteredData);

    console.log(result)
    return result;
  }


  @Post('/bulk-upload')
  @UseInterceptors(FileInterceptor('file'))
  bulkUpload(@UploadedFile() file: Express.Multer.File){
    const bulkAdd = this.resourceService.bulkUpload(file);
    return Response.ok('Resources are created successfully',bulkAdd);
  }
